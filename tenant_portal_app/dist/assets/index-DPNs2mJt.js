import{r,b as P,f as k,j as e,L as i}from"./react-vendor-Cz9WDxg-.js";import{u as _}from"./index-BHiZdJVs.js";import{A}from"./AuthLayout-Bqa0Hdmn.js";import{e as R,s as q,b as t,f as l,a as M}from"./shadows-D7BBuQ5e.js";import{a as W}from"./apiClient-DATCuIGb.js";import{E as D,u as F,p as O}from"./lucide-icons-D0L7Z31B.js";import{c as U,a as T,i as d,b as H}from"./nextui-vendor-BpFfdwSS.js";import"./vendor-BVwjo9X5.js";import"./utils-vendor-9uJw-9S8.js";import"./framer-motion-hFs7l1RU.js";const ee=()=>{const[c,x]=r.useState(""),[u,b]=r.useState(""),[m,j]=r.useState(""),[v,p]=r.useState(!1),[f,g]=r.useState(null),[h,y]=r.useState(!1),[o,S]=r.useState(!1),{login:w}=_(),C=P(),[z]=k(),E=z.get("redirect")||"/",N=async a=>{a.preventDefault(),g(null),p(!1),y(!0);try{const n=await W("/auth/login",{method:"POST",body:{username:c,password:u,mfaCode:m||void 0}});n.access_token&&(w(n.access_token),C(E))}catch(n){let s=n.message||"Login failed";if(typeof s=="string"&&s.includes(" - "))try{const L=s.split(" - ")[1];s=JSON.parse(L).message||s}catch{}s&&s.toLowerCase().includes("mfa")&&p(!0),g(s)}finally{y(!1)}};return e.jsx(A,{title:"Welcome back",subtitle:"Sign in to manage maintenance, payments, and more",children:e.jsx(U,{shadow:"lg",style:{boxShadow:R.card},children:e.jsxs(T,{style:{padding:q[6]},children:[e.jsxs("form",{className:"space-y-4",onSubmit:N,children:[e.jsx(d,{label:"Username",placeholder:"Enter your username",value:c,onChange:a=>x(a.target.value),autoComplete:"username",isRequired:!0,variant:"bordered",size:"lg"}),e.jsx(d,{label:"Password",placeholder:"Enter your password",type:o?"text":"password",value:u,onChange:a=>b(a.target.value),autoComplete:"current-password",isRequired:!0,variant:"bordered",size:"lg",endContent:e.jsx("button",{type:"button",onClick:()=>S(!o),className:"focus:outline-none","aria-label":o?"Hide password":"Show password",children:o?e.jsx(D,{size:20,style:{color:t.neutral[400]}}):e.jsx(F,{size:20,style:{color:t.neutral[400]}})})}),v&&e.jsx("div",{children:e.jsx(d,{label:"MFA Code",placeholder:"Enter 6-digit code",type:"text",inputMode:"numeric",value:m,onChange:a=>j(a.target.value),autoComplete:"one-time-code",isRequired:!0,variant:"bordered",size:"lg",description:"Enter the multi-factor authentication code sent to your device"})}),f&&e.jsxs("div",{className:"flex items-start gap-2 rounded-lg p-3",style:{backgroundColor:t.danger[50],border:`1px solid ${t.danger[200]}`},children:[e.jsx(O,{size:20,style:{color:t.danger[600],flexShrink:0}}),e.jsx("p",{style:{fontSize:l.sm,color:t.danger[700]},children:f})]}),e.jsx(H,{type:"submit",color:"primary",size:"lg",fullWidth:!0,isLoading:h,style:{fontSize:l.sm,fontWeight:M.semibold},children:h?"Signing in...":"Sign in"})]}),e.jsxs("div",{className:"mt-6 space-y-3 text-center",style:{fontSize:l.sm},children:[e.jsx("div",{children:e.jsx(i,{to:"/forgot-password",className:"font-medium hover:underline",style:{color:t.primary[600]},children:"Forgot password?"})}),e.jsxs("div",{style:{color:t.neutral[600]},children:["New here?"," ",e.jsx(i,{to:"/signup",className:"font-medium hover:underline",style:{color:t.primary[600]},children:"Create an account"})]}),e.jsxs("div",{style:{color:t.neutral[600]},children:["Applying for a unit?"," ",e.jsx(i,{to:"/rental-application",className:"font-medium hover:underline",style:{color:t.primary[600]},children:"Submit an application"})]})]})]})})})};export{ee as LoginPage,ee as default};
