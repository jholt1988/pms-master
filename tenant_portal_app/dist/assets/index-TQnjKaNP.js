import{r as o,b as $,j as e}from"./react-vendor-Cz9WDxg-.js";import{A as T}from"./AuthLayout-Bqa0Hdmn.js";import{e as H,s as C,b as t,a as h,f as i}from"./shadows-D7BBuQ5e.js";import{a as v}from"./apiClient-DATCuIGb.js";import{E as z,u as P,v as M,w as B,p as D}from"./lucide-icons-D0L7Z31B.js";import{c as F,a as X,i as g,o as Z,b as G}from"./nextui-vendor-BpFfdwSS.js";import"./vendor-BVwjo9X5.js";import"./framer-motion-hFs7l1RU.js";const te=()=>{const[f,q]=o.useState(""),[a,N]=o.useState(""),[y,k]=o.useState(""),[A]=o.useState("TENANT"),[c,E]=o.useState(!1),[u,L]=o.useState(!1),[r,b]=o.useState(null),[w,d]=o.useState(null),[x,S]=o.useState(!1),j=$();o.useEffect(()=>{(async()=>{try{const n=await v("/auth/password-policy");b(n)}catch{b({minLength:8,requireUppercase:!0,requireLowercase:!0,requireNumber:!0,requireSymbol:!0})}})()},[]);const O=()=>{if(!a)return 0;let s=0;const n=p();return s=n.filter(U=>U.met).length/n.length*100,Math.round(s)},p=()=>r?[{label:`At least ${r.minLength} characters`,met:a.length>=r.minLength},{label:"One uppercase letter",met:!r.requireUppercase||/[A-Z]/.test(a)},{label:"One lowercase letter",met:!r.requireLowercase||/[a-z]/.test(a)},{label:"One number",met:!r.requireNumber||/\d/.test(a)},{label:"One special character",met:!r.requireSymbol||/[!@#$%^&*(),.?":{}|<>]/.test(a)}].filter(s=>s.label.includes("uppercase")?r.requireUppercase:s.label.includes("lowercase")?r.requireLowercase:s.label.includes("number")?r.requireNumber:s.label.includes("special")?r.requireSymbol:!0):[],R=s=>s<40?t.danger[500]:s<70?t.warning[500]:t.success[500],W=async s=>{if(s.preventDefault(),d(null),a!==y){d("Passwords do not match");return}if(!p().every(m=>m.met)){d("Please meet all password requirements");return}S(!0);try{await v("/auth/register",{method:"POST",body:{username:f,password:a,role:A}}),j("/login")}catch(m){d(m.message)}finally{S(!1)}},l=O(),_=p();return e.jsx(T,{title:"Create your account",subtitle:"Access tenant services, payments, applications, and more",children:e.jsx(F,{shadow:"lg",style:{boxShadow:H.card},children:e.jsxs(X,{style:{padding:C[6]},children:[e.jsxs("form",{className:"space-y-4",onSubmit:W,children:[e.jsx(g,{label:"Username",placeholder:"Choose a username",value:f,onChange:s=>q(s.target.value),autoComplete:"username",isRequired:!0,variant:"bordered",size:"lg"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{label:"Password",placeholder:"Create a strong password",type:c?"text":"password",value:a,onChange:s=>N(s.target.value),autoComplete:"new-password",isRequired:!0,variant:"bordered",size:"lg",endContent:e.jsx("button",{type:"button",onClick:()=>E(!c),className:"focus:outline-none","aria-label":c?"Hide password":"Show password",children:c?e.jsx(z,{size:20,style:{color:t.neutral[400]}}):e.jsx(P,{size:20,style:{color:t.neutral[400]}})})}),a&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(Z,{size:"sm",value:l,color:l<40?"danger":l<70?"warning":"success","aria-label":"Password strength"}),e.jsx("p",{style:{fontSize:i.xs,color:R(l),fontWeight:h.medium},children:l<40?"Weak password":l<70?"Medium strength":"Strong password"})]})]}),e.jsx(g,{label:"Confirm Password",placeholder:"Re-enter your password",type:u?"text":"password",value:y,onChange:s=>k(s.target.value),autoComplete:"new-password",isRequired:!0,variant:"bordered",size:"lg",endContent:e.jsx("button",{type:"button",onClick:()=>L(!u),className:"focus:outline-none","aria-label":u?"Hide password":"Show password",children:u?e.jsx(z,{size:20,style:{color:t.neutral[400]}}):e.jsx(P,{size:20,style:{color:t.neutral[400]}})})}),r&&a&&e.jsxs("div",{className:"rounded-lg p-3",style:{backgroundColor:t.primary[50],border:`1px solid ${t.primary[100]}`},children:[e.jsx("p",{style:{fontSize:i.sm,fontWeight:h.semibold,color:t.primary[900],marginBottom:C[2]},children:"Password requirements:"}),e.jsx("ul",{className:"space-y-1",children:_.map((s,n)=>e.jsxs("li",{className:"flex items-center gap-2",children:[s.met?e.jsx(M,{size:16,style:{color:t.success[600]}}):e.jsx(B,{size:16,style:{color:t.neutral[400]}}),e.jsx("span",{style:{fontSize:i.xs,color:s.met?t.success[700]:t.neutral[600]},children:s.label})]},n))})]}),w&&e.jsxs("div",{className:"flex items-start gap-2 rounded-lg p-3",style:{backgroundColor:t.danger[50],border:`1px solid ${t.danger[200]}`},children:[e.jsx(D,{size:20,style:{color:t.danger[600],flexShrink:0}}),e.jsx("p",{style:{fontSize:i.sm,color:t.danger[700]},children:w})]}),e.jsx(G,{type:"submit",color:"primary",size:"lg",fullWidth:!0,isLoading:x,style:{fontSize:i.sm,fontWeight:h.semibold},children:x?"Creating account...":"Create account"})]}),e.jsxs("div",{className:"mt-6 text-center",style:{fontSize:i.sm,color:t.neutral[600]},children:["Already have an account?"," ",e.jsx("button",{type:"button",onClick:()=>j("/login"),className:"font-medium hover:underline",style:{color:t.primary[600]},children:"Sign in"})]})]})})})};export{te as SignupPage,te as default};
