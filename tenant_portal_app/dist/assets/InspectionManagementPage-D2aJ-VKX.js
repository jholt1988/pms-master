import{j as e,r as a}from"./react-vendor-Cz9WDxg-.js";import{A as X,u as Y}from"./index-BHiZdJVs.js";import{a as I}from"./apiClient-DATCuIGb.js";import{u as U}from"./useViewportCategory-ClZR3Wdj.js";import{A as D,c as E}from"./framer-motion-hFs7l1RU.js";import{g as Z}from"./lucide-icons-D0L7Z31B.js";import{b as i,m as k,f as L,g as M,h as P,j as O}from"./nextui-vendor-BpFfdwSS.js";import"./vendor-BVwjo9X5.js";import"./utils-vendor-9uJw-9S8.js";const ee=({children:r,pageTitle:n,actions:o})=>e.jsx(X,{children:e.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[(n||o)&&e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n&&e.jsx("h1",{className:"text-2xl font-bold",children:n}),o&&e.jsx("div",{className:"flex items-center space-x-2",children:o})]}),r]})}),te=({master:r,detail:n,showDetail:o})=>{const d=U(),m=d==="mobile"||d==="tablet-portrait";return e.jsx("div",{className:"flex h-full",children:m?e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx(D,{children:!o&&e.jsx(E.div,{initial:{x:"-100%"},animate:{x:0},exit:{x:"-100%"},transition:{duration:.3,ease:"easeInOut"},className:"absolute w-full h-full",children:r},"master")}),e.jsx(D,{children:o&&e.jsx(E.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{duration:.3,ease:"easeInOut"},className:"absolute w-full h-full",children:n},"detail")})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-1/3 border-r border-gray-200 dark:border-gray-800",children:r}),e.jsx("div",{className:"w-2/3",children:n})]})})},se={propertyId:"",unitId:"",status:"",type:"",startDate:"",endDate:""},_=r=>{switch(r){case"SCHEDULED":return"bg-blue-100 text-blue-800";case"IN_PROGRESS":return"bg-yellow-100 text-yellow-800";case"COMPLETED":return"bg-emerald-100 text-emerald-800";case"CANCELLED":return"bg-rose-100 text-rose-800";default:return"bg-gray-100 text-gray-800"}},A=r=>r.replace("_"," ").replace(/\b\w/g,n=>n.toUpperCase());function pe(){const{token:r}=Y(),[n,o]=a.useState([]),[d,m]=a.useState([]),[R,j]=a.useState(!0),[N,b]=a.useState(null),[l,F]=a.useState(null),[x,g]=a.useState(se),[T,y]=a.useState(!1),[$,u]=a.useState(!1),[G,h]=a.useState(!1),[p,c]=a.useState({propertyId:"",unitName:"",type:"ROUTINE",scheduledDate:"",notes:""}),[H,v]=a.useState(""),f=U(),w=a.useCallback(async()=>{j(!0),b(null);try{const t=new URLSearchParams;Object.entries(x).forEach(([W,C])=>{C&&t.append(W,C)});const s=t.toString()?`?${t.toString()}`:"",Q=await I(`/inspections${s}`,{token:r});o(Q?.data??[])}catch(t){o([]),b(t.message??"Failed to load inspections")}finally{j(!1)}},[x,r]),S=a.useCallback(async()=>{try{const t=await I("/properties?limit=500",{token:r});m(t?.data??[])}catch{m([])}},[r]);a.useEffect(()=>{S()},[S]),a.useEffect(()=>{w()},[w]);const q=t=>{F(t),(f==="mobile"||f==="tablet-portrait")&&y(!0)},z=()=>{y(!1)},B=t=>{t.preventDefault(),u(!1),c({propertyId:"",unitName:"",type:"ROUTINE",scheduledDate:"",notes:""})},J=t=>{t.preventDefault(),h(!1),v("")},V=e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Inspection Management"}),e.jsx("p",{className:"text-sm text-foreground-500",children:"Monitor upcoming, in-progress, and completed inspections."})]}),e.jsx(i,{color:"primary",onClick:()=>u(!0),children:"Schedule Inspection"})]}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-6 gap-4",children:[e.jsxs("label",{className:"flex flex-col text-sm text-foreground-500",children:["Property",e.jsxs("select",{className:"border border-input rounded px-3 py-2 mt-1",value:x.propertyId,onChange:t=>g(s=>({...s,propertyId:t.target.value})),children:[e.jsx("option",{value:"",children:"All properties"}),d.map(t=>e.jsx("option",{value:String(t.id),children:t.name},t.id))]})]}),e.jsxs("label",{className:"flex flex-col text-sm text-foreground-500",children:["Status",e.jsxs("select",{className:"border border-input rounded px-3 py-2 mt-1",value:x.status,onChange:t=>g(s=>({...s,status:t.target.value})),children:[e.jsx("option",{value:"",children:"Any"}),e.jsx("option",{value:"SCHEDULED",children:"Scheduled"}),e.jsx("option",{value:"IN_PROGRESS",children:"In Progress"}),e.jsx("option",{value:"COMPLETED",children:"Completed"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})]}),e.jsxs("label",{className:"flex flex-col text-sm text-foreground-500",children:["Inspection Type",e.jsx("input",{className:"border border-input rounded px-3 py-2 mt-1",placeholder:"Routine, Move-in, etc.",value:x.type,onChange:t=>g(s=>({...s,type:t.target.value}))})]})]})}),N&&e.jsx("div",{className:"bg-rose-50 border border-rose-200 text-rose-700 px-4 py-3 rounded mb-4",children:N}),R?e.jsx("div",{className:"text-center py-12",children:"Loading inspections..."}):e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-foreground-500",children:"Property / Unit"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-foreground-500",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-foreground-500",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-foreground-500",children:"Scheduled"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold uppercase tracking-wide text-foreground-500",children:"Inspector"})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[n.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-6 text-center text-sm text-foreground-500",children:"No inspections match the current filters."})}),n.map(t=>e.jsxs("tr",{onClick:()=>q(t),className:"cursor-pointer hover:bg-gray-50",children:[e.jsxs("td",{className:"px-4 py-3 text-sm",children:[e.jsx("p",{className:"font-semibold text-foreground",children:t.unit.property.name}),e.jsx("p",{className:"text-xs text-foreground-500",children:t.unit.name})]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:A(t.type)}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${_(t.status)}`,children:t.status})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(t.scheduledDate).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3 text-sm",children:t.inspector?.username??"Unassigned"})]},t.id))]})]})})]}),K=e.jsx("div",{className:"p-6 h-full",children:l?e.jsxs(e.Fragment,{children:[(f==="mobile"||f==="tablet-portrait")&&e.jsx(i,{isIconOnly:!0,variant:"light",onClick:z,className:"mb-4",children:e.jsx(Z,{size:20})}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden p-6 flex flex-col gap-4 h-full",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold mb-1",children:[A(l.type)," Inspection"]}),e.jsxs("p",{className:"text-sm text-foreground-500",children:[l.unit.property.name," Â· ",l.unit.name]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx("span",{className:`px-3 py-1 rounded text-sm font-semibold ${_(l.status)}`,children:l.status}),e.jsxs("span",{className:"text-sm text-foreground-500",children:["Scheduled: ",new Date(l.scheduledDate).toLocaleString()]}),l.completedDate&&e.jsxs("span",{className:"text-sm text-foreground-500",children:["Completed: ",new Date(l.completedDate).toLocaleString()]})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground-500",children:"Inspector"}),e.jsx("p",{className:"text-sm",children:l.inspector?.username??"Unassigned"})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground-500",children:"Notes"}),e.jsx("p",{className:"text-sm text-foreground",children:l.notes??"No notes yet"})]}),l.findings&&e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground-500",children:"Findings"}),e.jsx("pre",{className:"text-xs text-foreground-500 bg-slate-50 p-3 rounded whitespace-pre-wrap wrap-break-word",children:JSON.stringify(l.findings,null,2)})]}),l.photos&&l.photos.length>0&&e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground-500",children:"Photos"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:l.photos.map(t=>e.jsx("img",{src:t.url,alt:t.caption||"Inspection photo",className:"w-full h-24 object-cover rounded"},t.id))})]}),e.jsx("div",{className:"flex gap-2 mt-auto",children:e.jsx(i,{variant:"light",onClick:()=>h(!0),children:"Mark Complete"})})]})]}):e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("p",{className:"text-gray-500",children:"Select an inspection to see the details."})})});return e.jsxs(ee,{pageTitle:"Inspection Management",children:[e.jsx(te,{master:V,detail:K,showDetail:T}),e.jsx(k,{isOpen:$,onClose:()=>u(!1),children:e.jsxs(L,{children:[e.jsx(M,{children:"Schedule Inspection"}),e.jsx(P,{children:e.jsxs("form",{id:"schedule-inspection-form",onSubmit:B,className:"space-y-4",children:[e.jsxs("label",{className:"flex flex-col text-sm text-foreground-500",children:["Property",e.jsxs("select",{className:"border border-input rounded px-3 py-2 mt-1",value:p.propertyId,onChange:t=>c(s=>({...s,propertyId:t.target.value})),children:[e.jsx("option",{value:"",children:"Select property"}),d.map(t=>e.jsx("option",{value:String(t.id),children:t.name},t.id))]})]}),e.jsxs("label",{className:"flex flex-col text-sm text-foreground-500",children:["Unit",e.jsx("input",{className:"border border-input rounded px-3 py-2 mt-1",placeholder:"Unit name or identifier",value:p.unitName,onChange:t=>c(s=>({...s,unitName:t.target.value}))})]}),e.jsxs("label",{className:"flex flex-col text-sm text-foreground-500",children:["Inspection Type",e.jsx("input",{className:"border border-input rounded px-3 py-2 mt-1",placeholder:"Routine, Move-in, Move-out",value:p.type,onChange:t=>c(s=>({...s,type:t.target.value}))})]}),e.jsxs("label",{className:"flex flex-col text-sm text-foreground-500",children:["Scheduled At",e.jsx("input",{type:"datetime-local",className:"border border-input rounded px-3 py-2 mt-1",value:p.scheduledDate,onChange:t=>c(s=>({...s,scheduledDate:t.target.value}))})]}),e.jsxs("label",{className:"flex flex-col text-sm text-foreground-500",children:["Notes",e.jsx("textarea",{className:"border border-input rounded px-3 py-2 mt-1",rows:3,value:p.notes,onChange:t=>c(s=>({...s,notes:t.target.value}))})]})]})}),e.jsxs(O,{children:[e.jsx(i,{variant:"light",onClick:()=>u(!1),children:"Cancel"}),e.jsx(i,{color:"primary",type:"submit",form:"schedule-inspection-form",children:"Schedule"})]})]})}),e.jsx(k,{isOpen:G,onClose:()=>h(!1),children:e.jsxs(L,{children:[e.jsx(M,{children:"Complete Inspection"}),e.jsx(P,{children:e.jsx("form",{id:"complete-inspection-form",onSubmit:J,className:"space-y-4",children:e.jsxs("label",{className:"flex flex-col text-sm text-foreground-500",children:["Completion Notes",e.jsx("textarea",{className:"border border-input rounded px-3 py-2 mt-1",rows:3,value:H,onChange:t=>v(t.target.value)})]})})}),e.jsxs(O,{children:[e.jsx(i,{variant:"light",onClick:()=>h(!1),children:"Cancel"}),e.jsx(i,{color:"success",type:"submit",form:"complete-inspection-form",children:"Mark Complete"})]})]})})]})}export{pe as default};
