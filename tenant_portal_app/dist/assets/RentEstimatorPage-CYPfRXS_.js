import{r as s,j as e}from"./react-vendor-Cz9WDxg-.js";import{u as E}from"./index-BHiZdJVs.js";import{a as y}from"./apiClient-DATCuIGb.js";import"./vendor-BVwjo9X5.js";import"./nextui-vendor-BpFfdwSS.js";import"./framer-motion-hFs7l1RU.js";import"./utils-vendor-9uJw-9S8.js";import"./lucide-icons-D0L7Z31B.js";const I=()=>{const[c,j]=s.useState([]),[a,N]=s.useState(""),[m,v]=s.useState([]),[o,u]=s.useState(""),[x,l]=s.useState(null),[g,d]=s.useState(null),[S,p]=s.useState(!0),[h,b]=s.useState(!1),[f,i]=s.useState(null),n=E()?.token;s.useEffect(()=>{(async()=>{if(!n){p(!1);return}try{const r=await y("/properties",{token:n});j(r)}catch(r){i(r.message)}finally{p(!1)}})()},[n]),s.useEffect(()=>{if(a){const t=c.find(r=>r.id===Number(a));t&&v(t.units)}},[a,c]);const w=async()=>{if(!n){i("Sign in to estimate rent.");return}if(!a||!o){i("Select both a property and unit to run an estimate.");return}b(!0),i(null),l(null),d(null);try{const t=await y(`/rent-estimator?propertyId=${a}&unitId=${o}`,{token:n});l(t.estimatedRent),d(t.details)}catch(t){i(t.message)}finally{b(!1)}};return S?e.jsx("div",{className:"p-4 text-sm text-gray-600",children:"Loading property data…"}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("header",{className:"space-y-2",children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Rent estimator"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Pair historical rent rolls with applicant data to forecast the optimal rate per unit."})]}),f&&e.jsx("div",{className:"rounded-md border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-700",children:f}),e.jsxs("div",{className:"grid gap-8 lg:grid-cols-[minmax(0,1.2fr)_minmax(0,1fr)]",children:[e.jsxs("section",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Select a unit"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Choose a property and unit to benchmark rent against comparable leases."}),e.jsxs("div",{className:"mt-6 space-y-4 text-sm text-gray-700",children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700",children:["Property",e.jsxs("select",{value:a,onChange:t=>{N(t.target.value),u(""),l(null),d(null)},className:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500",children:[e.jsx("option",{value:"",children:"Select property"}),c.map(t=>e.jsxs("option",{value:t.id,children:[t.name," ",t.address?`· ${t.address}`:""]},t.id))]})]}),e.jsxs("label",{className:"block text-xs font-medium text-gray-700",children:["Unit",e.jsxs("select",{value:o,onChange:t=>{u(t.target.value),l(null),d(null)},disabled:m.length===0,className:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:cursor-not-allowed disabled:bg-gray-100",children:[e.jsx("option",{value:"",children:"Select unit"}),m.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),m.length===0&&a&&e.jsx("span",{className:"mt-1 block text-xs text-gray-500",children:"No unit data available for this property."})]}),e.jsx("button",{type:"button",onClick:w,disabled:h||!a||!o,className:"inline-flex items-center rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 disabled:cursor-not-allowed disabled:bg-indigo-300",children:h?"Estimating…":"Estimate rent"})]})]}),e.jsxs("section",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Benchmark results"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Forecasts blend market comps, income ratios, and debt-to-income thresholds."}),x!=null?e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"rounded-md border border-indigo-100 bg-indigo-50 p-4",children:[e.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-indigo-600",children:"Suggested monthly rent"}),e.jsxs("p",{className:"mt-2 text-3xl font-semibold text-indigo-900",children:["$",x.toLocaleString(void 0,{minimumFractionDigits:0})]})]}),g&&e.jsx("div",{className:"rounded-md border border-gray-200 bg-gray-50 p-4 text-sm text-gray-700",children:g.split(new RegExp("(?<=[.?!])\\s+")).map((t,r)=>e.jsx("p",{className:"mt-1 first:mt-0",children:t},r))})]}):e.jsx("div",{className:"mt-6 rounded border border-dashed border-gray-300 bg-gray-50 px-4 py-8 text-sm text-gray-500",children:"Select a unit and run the estimator to see suggested rent and supporting rationale."})]})]})]})};export{I as default};
